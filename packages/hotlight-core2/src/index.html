<!DOCTYPE html>
<html dir="ltr" lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=5.0" />
    <title>Stencil Component Starter 2000</title>

    <!--  <link rel="stylesheet" href="/build/commandk.css" />-->
    <script type="module" src="/build/hotlight.esm.js"></script>
    <script nomodule src="/build/hotlight.js"></script>

    <script>
      document.addEventListener('hotlight:trigger', (e) => {
        const trigger = e.detail;
        console.log(trigger);
      })

    </script>


<template id="hotlight-modal">
  <style>
    div {
      background: black;
      color: white;
    }
  </style>

  <div class="modal-container">
    <div class="modal hidden">
      <div class="input-wrapper">
        <hotlight-input />
      </div>
    </div>
  </div>
  <div
    class="backdrop hidden"
  />
</template>

<script>
const defaultConfig = {
  token: "fake"
}

class Input extends HTMLElement {
  constructor() {
    super();
    console.log("input init");
  }
}

class Modal extends HTMLElement {
  constructor() {
    super();    
    let template = document.getElementById('hotlight-modal');
    let templateContent = template.content;
    const shadowRoot = this
      .attachShadow({
        mode: 'open'
      })
      .appendChild(templateContent.cloneNode(true));

    this._config = defaultConfig;
    this._actions = [];

    this.container = this.shadowRoot.querySelector(".modal-container");
    //this.modal = this.shadowRoot.querySelector(".modal-container");
    //this.backdrop = this.shadowRoot.querySelector(".modal-container");

    window.addEventListener("keydown", (e) => {
      if(e.key === "k" && e.metaKey) {
        this.toggle();
        e.preventDefault();
      }
    });
  }

  toggle() {
    console.log("TOGGLE");
  }

  /*
  static get observedAttributes() {
    return ['value'];
  }

  attributeChangedCallback(attrName, oldValue, newValue) {
    if (attrName === 'value') {
      console.log(attrName, oldValue, newValue);
      this.value = parseInt(newValue, 10);
    }
  }
  */

  set config(value) {
    const c = { ...defaultConfig, ...value };
    this._config = c;
  }

  get config() {
    return this._config;
  }
}

customElements.define("hotlight-input", Input);
customElements.define("hotlight-modalx", Modal);


</script>
  </head>
  <body>
    <hotlight-modal></hotlight-modal>
    <hotlight-modalx value="this is value"></hotlight-modalx>
  <script>

const x = document.querySelector("hotlight-modalx");
x.config = { yo: "what" }
console.log(x.config)

const config = {
  //opened: true,
  //stayOpened: true,

  //query: "a",
  //maxHits: 5,
  sources: {
    greets: (query) => { // perhaps option to throttle
      const hits = [{
        title: "jonte"          
      },{
        title: "jon",
        hotkeys: "jo"
      }];

      return new Promise((res) => setTimeout(() => res(hits), 500));
    }
  }
}

const all = Array.from(new Array(1000))
  .map((x, i) => ({
    title: `${i} Use Hotlight With React`,
    trigger: "https://hotlight.dev",
    category: "Documentation"
  }))
    console.log(all.length, ' actions');

const calculator = [{
  title: "Calculate",
  category: "Utils",
  trigger: () => {}
},{
  title: "",
  parentTitle: "Calculate",
  trigger: function (query, context) {
    const str = query.split(" ");
    console.log(str);
    //eval(query);
  },
}];

const greetings = [{
  title: "Add greet",
  category: "Greets",
  trigger: "/greetings/new"
}]

const actions = [
{
  title: "Use Hotlight With React",
  trigger: "https://hotlight.dev",
  category: "Documentation"
},{
  title: "Hotlight and Vue",
  trigger: "https://hotlight.dev",
  category: "Documentation"
},{
  title: "Hotlight and Svelte",
  trigger: "https://hotlight.dev/svelte",
  category: "Documentation"
},{
  title: "Alert hej",
  trigger: function (query, context) {
    alert(query);
  }
},{
  title: "Find by id (child actions)",
  trigger: function (query, context) {
    return new Promise((res) => {
      setTimeout(() => {
        return [{
          title: "yo",
          trigger: "https://yo.com"
        },{
          title: "docs",
          trigger: "https://arnklint.com"
        }]
      }, 1000);
    });
    return 
  }
},{
  title: "Parent",
  trigger: function(query, context) {
    console.log(query, context);
  }
},{
  title: "Child",
  trigger: function(query, context) {
    console.log(context);
  },
  parentTitle: "Parent"
},{
  title: "Second child",
  trigger: "https://jonas.arnklint.com",
  parentTitle: "Parent"
},{
  title: "Product",
  trigger: "https://operator.com/product/secondpath/longpath",
}].concat(...all, ...calculator, ...greetings);

const c = document.querySelector('hotlight-modal');
c.config = config;
c.actions = actions;
  </script>

    <h1>Hotlight</h1>

    <p>
      The only cmd+k you need for your saas or whatever...
    </p>

    <p class="backdrop" />

    <h2>Open the command prompt</h2>
    <pre>
      <code>
        let open = new Event('hotlight:open');
        window.dispatchEvent(open);
      </code>
    </pre>

    Or just press <strong>CMD+K</strong> and use the same keyboard combination for closing it again. 

    <h2>Listen to triggers</h2>
    <pre>
      <code>
        document.addEventListener('hotlight:trigger', (e) => {
          const trigger = e.detail;
          console.log(trigger);
        })
      </code>
    </pre>

    <h2>Framework support</h2>
    <p>Use Hotlight in any framework. At its core, Hotlight is a web component that comes with helper packages for different frameworks so that you'll easily integrate it anywhere. Any framework specific contribution is greatly appreciated.</p>

    

    <h2>Features</h2>
    <h3>Actions</h3>
    <p>Predefine any action in your app or page. An action is triggered by searching for it and then pressing enter. Listen to triggers to hook on to actions as described above.</p>
    <h3>Hot Keys</h3>
    <p>Actions can be performed with hot keys or simply by searching for its name. Hot keys are configurable with ease in one central place.</p>
    <h3>Objects</h3>
    <p>Define objects to be able to interact with them and display them as results in Hotlight.</p>
    <p>Example: You run a CRM and the user wants to be able to search contacts. Define objects so that they will be found when searching for them. An object can adhere from any source, such as a third party API or your own API's.</p>
    <h3>Pages</h3>
    <p>If a query matches a page title or description, the user can quickly hit enter to go to that page. This is a great feature for apps with documentation and faqs.</p>
    <h3>Integrations</h3>
    <p>Do something with x. Integrations are a powerful way to serve the user with the ability to find or manipulate data from third party API's. One example would be the ability to attach information from a third party to an object. Like, if you run a crm and an email list you could integrate with the email list provider so that your users can search it to find if it's there.</p>
    <h3>Sources</h3>
    <p>Define multiple sources that are included in the search results. May it be your backend or some special entity you want the user to quickly access.</p>
    <h3>Analytics</h3>
    <p>Know what users are looking for and curate the results based on that and what the intents look like.</p>

    <p style="height: 400px">Make page longer</p> 
  </body>
</html>
